(function(){function b(c){var d=this;d.rangeslider=new a(d,c);function e(g){var f=d.rangeslider;f.rstb.init_();f.box.init_();f.bar.init_();f.left.init_();f.right.init_();f.tp.init_();f.tpl.init_();f.tpr.init_();if(f.options.hidden){f.hide()}if(f.options.locked){f.lock()}if(f.options.panel==false){f.hidePanel()}f._reset()}this.on("durationchange",e);console.log("Loaded Plugin RangeSlider")}videojs.plugin("rangeslider",b);function a(d,c){var d=d||this;this.player=d;this.components={};c=c||{};if(!c.hasOwnProperty("locked")){c.locked=false}if(!c.hasOwnProperty("hidden")){c.hidden=true}if(!c.hasOwnProperty("panel")){c.panel=true}this.options=c;this.init()}a.prototype={init:function(){var c=this.player||{};this.updatePrecision=3;this.start=0;this.end=0;var d=c.controlBar.progressControl.seekBar;this.components.RSTimeBar=d.RSTimeBar;this.rstb=this.components.RSTimeBar;this.box=this.rstb.SeekRSBar;this.bar=this.box.SelectionBar;this.left=this.box.SelectionBarLeft;this.right=this.box.SelectionBarRight;this.tp=this.box.TimePanel;this.tpl=this.tp.TimePanelLeft;this.tpr=this.tp.TimePanelRight},lock:function(){this.options.locked=true;if(typeof this.box!="undefined"){videojs.addClass(this.box.el_,"locked")}},unlock:function(){this.options.locked=false;if(typeof this.box!="undefined"){videojs.removeClass(this.box.el_,"locked")}},show:function(){this.options.hidden=false;if(typeof this.rstb!="undefined"){this.rstb.show()}},hide:function(){this.options.hidden=true;if(typeof this.rstb!="undefined"){this.rstb.hide()}},showPanel:function(){this.options.panel=true;if(typeof this.tp!="undefined"){this.tp.show()}},hidePanel:function(){this.options.panel=false;if(typeof this.tp!="undefined"){this.tp.hide()}},setValue:function(c,g){var e=this._percent(g);var d=(c===0||c===1);var f=!this.locked;if(f&&d){this.box.setPosition(c,e)}},getValues:function(){var d={},e,c;e=this.start||this._getArrowValue(0);c=this.end||this._getArrowValue(1);return{start:e,end:c}},playBetween:function(d,c){this.player.currentTime(d);this.player.play();this.show();if(this.options.locked){this.unlock();this.setValue(0,d);this.setValue(1,c);this.lock()}else{this.setValue(0,d);this.setValue(1,c)}this.bar.activatePlay(d,c)},_getArrowValue:function(d){var d=d||0;var e=this.player.duration();e=typeof e=="undefined"?0:e;var c=this[d===0?"left":"right"].el_.style.left.replace("%","");if(c==""){c=d===0?0:100}return videojs.round(this._seconds(c/100),this.updatePrecision-1)},_percent:function(d){var c=this.player.duration();if(isNaN(c)){return 0}return Math.min(1,Math.max(0,d/c))},_seconds:function(c){var d=this.player.duration();if(isNaN(d)){return 0}return Math.min(d,Math.max(0,c*d))},_reset:function(){var c=this.player.duration();this.setValue(0,0);this.setValue(1,c)},_formatTime:function(c){var e=this.player.duration();var d=Math.min(e,Math.max(0,e*c/100));return videojs.formatTime(d)},};videojs.Player.prototype.lockSlider=function(){return this.rangeslider.lock()};videojs.Player.prototype.unlockSlider=function(){return this.rangeslider.unlock()};videojs.Player.prototype.showSlider=function(){return this.rangeslider.show()};videojs.Player.prototype.hideSlider=function(){return this.rangeslider.hide()};videojs.Player.prototype.showSliderPanel=function(){return this.rangeslider.showPanel()};videojs.Player.prototype.hideSliderPanel=function(){return this.rangeslider.hidePanel()};videojs.Player.prototype.setValueSlider=function(c,d){return this.rangeslider.setValue(c,d)};videojs.Player.prototype.playBetween=function(d,c){return this.rangeslider.playBetween(d,c)};videojs.Player.prototype.getValueSlider=function(){return this.rangeslider.getValues()};videojs.SeekBar.prototype.options_.children.RSTimeBar={};videojs.RSTimeBar=videojs.Component.extend({init:function(d,c){console.log(d);videojs.Component.call(this,d,c)}});videojs.RSTimeBar.prototype.init_=function(){this.rs=this.player_.rangeslider};videojs.RSTimeBar.prototype.options_={children:{SeekRSBar:{}}};videojs.RSTimeBar.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-timebar-RS",innerHTML:""})};videojs.SeekRSBar=videojs.Component.extend({init:function(d,c){videojs.Component.call(this,d,c);this.on("mousedown",this.onMouseDown);this.handleValue=null}});videojs.SeekRSBar.prototype.init_=function(){this.rs=this.player_.rangeslider};videojs.SeekRSBar.prototype.options_={children:{SelectionBar:{},SelectionBarLeft:{},SelectionBarRight:{},TimePanel:{}}};videojs.SeekRSBar.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-holder"})};videojs.SeekRSBar.prototype.onMouseDown=function(c){c.preventDefault();videojs.blockTextSelection();if(!this.rs.options.locked){videojs.on(document,"mousemove",videojs.bind(this,this.onMouseMove));videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp))}};videojs.SeekRSBar.prototype.onMouseUp=function(c){videojs.off(document,"mousemove",this.onMouseMove,false);videojs.off(document,"mouseup",this.onMouseUp,false)};videojs.SeekRSBar.prototype.onMouseMove=function(c){var d=this.calculateDistance(c);if(this.rs.left.pressed){this.setPosition(0,d)}else{if(this.rs.right.pressed){this.setPosition(1,d)}}};videojs.SeekRSBar.prototype.setPosition=function(i,c){var h=this;if(this.rs.options.locked){return false}if(isNaN(c)){return false}if(!(i===0||i===1)){return false}var f=this.rs.left.el_,d=this.rs.right.el_,g=this.rs[i===0?"left":"right"].el_,e=this.rs.tpr.el_,j=this.rs.tpl.el_,k=this.rs.bar;this.handleValue=c;if((i===0?k.updateLeft(c):k.updateRight(c))){g.style.left=videojs.round(this.handleValue*100,2)+"%";i===0?k.updateLeft(c):k.updateRight(c);this.rs[i===0?"start":"end"]=this.rs._seconds(c);if(i===0&&videojs.round(this.handleValue*100,2)>=90){f.style.zIndex=25}else{f.style.zIndex=10}var m,n,l;m=this.player_.isFullScreen?96:92;n=this.player_.isFullScreen?0.1:0.5;l=this.player_.isFullScreen?3.75:7.5;if(i===0){j.style.left=Math.max(n,Math.min(m,videojs.round(this.handleValue*100-l/2,2)))+"%";if((e.style.left.replace("%","")-j.style.left.replace("%",""))<=l){j.style.left=Math.max(n,Math.min(m,e.style.left.replace("%","")-l))+"%"}j.children[0].innerText=this.rs._formatTime(f.style.left.replace("%",""))}else{e.style.left=Math.max(n,Math.min(m,videojs.round(this.handleValue*100-l/2,2)))+"%";if(((e.style.left.replace("%","")||100)-j.style.left.replace("%",""))<=l){e.style.left=Math.max(n,Math.min(m,j.style.left.replace("%","")-0+l))+"%"}e.children[0].innerText=this.rs._formatTime(d.style.left.replace("%",""))}}return true};videojs.SeekRSBar.prototype.calculateDistance=function(e){var c=this.getRSTBX();var d=this.getRSTBWidth();var f=this.getWidth();c=c+(f/2);d=d-f;return Math.max(0,Math.min(1,(e.pageX-c)/d))};videojs.SeekRSBar.prototype.getRSTBWidth=function(){return this.rs.rstb.el_.offsetWidth};videojs.SeekRSBar.prototype.getRSTBX=function(){return videojs.findPosition(this.rs.rstb.el_).left};videojs.SeekRSBar.prototype.getWidth=function(){return this.rs.left.el_.offsetWidth};videojs.SeekRSBar.prototype.getOffsetLeftPercent=function(c){return c/this.getRSTBWidth()};videojs.SeekRSBar.prototype.getRawValue=function(){return this.handleValue};videojs.SeekRSBar.prototype.getValue=function(){if(this.handleValue!==null){return videojs.round(this.handleValue*this.player.duration(),2)}return null};videojs.SeekRSBar.prototype.setRawValue=function(c){this.handleValue=c};videojs.SeekRSBar.prototype.setBarUpdateHandler=function(c){this.updateBar=c};videojs.SelectionBar=videojs.Component.extend({init:function(d,c){videojs.Component.call(this,d,c);this.on("mouseup",this.onMouseUp);this.fired=false}});videojs.SelectionBar.prototype.init_=function(){this.rs=this.player_.rangeslider};videojs.SelectionBar.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-selectionbar-RS"})};videojs.SelectionBar.prototype.onMouseUp=function(){var h=this.rs.left.el_.style.left.replace("%",""),d=this.rs.right.el_.style.left.replace("%",""),g=this.player_.duration(),c=this.rs.updatePrecision,e=videojs.round(h*g/100,c),f=videojs.round(d*g/100,c);this.player_.currentTime(e);this.player_.play();this.rs.bar.activatePlay(e,f)};videojs.SelectionBar.prototype.updateLeft=function(f){var g=this.rs.right.el_.offsetLeft;var c=this.rs.box.getOffsetLeftPercent(g);var e=this.rs.box.getOffsetLeftPercent(g)-f;var d=this.rs.updatePrecision;if(videojs.round(f,d)<=videojs.round(c,d)){this.rs.bar.el_.style.left=videojs.round(f*100,d)+"%";this.rs.bar.el_.style.width=videojs.round(e*100,d)+"%";return true}return false};videojs.SelectionBar.prototype.updateRight=function(g){var h=this.rs.left.el_.offsetLeft;var e=this.rs.box.getOffsetLeftPercent(h);var f=g-this.rs.box.getOffsetLeftPercent(h);var d=this.rs.updatePrecision;if(videojs.round(g,d)>=videojs.round(e,d)){var c=videojs.round(f*100,d);this.rs.bar.el_.style.width=c+"%";this.rs.bar.el_.style.left=videojs.round(g*100-c,d)+"%";return true}return false};videojs.SelectionBar.prototype.activatePlay=function(d,c){this.timeStart=d;this.timeEnd=c;this.player_.on("timeupdate",function(){this.rangeslider.bar._processPlay()})};videojs.SelectionBar.prototype.suspendPlay=function(){this.fired=false;this.player_.off("timeupdate",function(){this.rangeslider.bar._processPlay()})};videojs.SelectionBar.prototype._processPlay=function(d,c){if(this.player_.currentTime()>=this.timeStart&&(this.timeEnd<0||this.player_.currentTime()<this.timeEnd)){if(this.fired){return}this.fired=true}else{if(!this.fired){return}this.fired=false;this.player_.currentTime(this.timeEnd);this.player_.pause();this.suspendPlay()}};videojs.SelectionBarLeft=videojs.Component.extend({init:function(d,c){videojs.Component.call(this,d,c);this.on("mousedown",this.onMouseDown);this.pressed=false}});videojs.SelectionBarLeft.prototype.init_=function(){this.rs=this.player_.rangeslider};videojs.SelectionBarLeft.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-handle vjs-selectionbar-left-RS",innerHTML:'<div class="vjs-selectionbar-arrow-RS"></div><div class="vjs-selectionbar-line-RS"></div>'})};videojs.SelectionBarLeft.prototype.onMouseDown=function(c){c.preventDefault();videojs.blockTextSelection();if(!this.rs.options.locked){this.pressed=true;videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp));videojs.addClass(this.el_,"active")}};videojs.SelectionBarLeft.prototype.onMouseUp=function(c){videojs.off(document,"mouseup",this.onMouseUp,false);videojs.removeClass(this.el_,"active");if(!this.rs.options.locked){this.pressed=false}};videojs.SelectionBarRight=videojs.Component.extend({init:function(d,c){videojs.Component.call(this,d,c);this.on("mousedown",this.onMouseDown);this.pressed=false}});videojs.SelectionBarRight.prototype.init_=function(){this.rs=this.player_.rangeslider};videojs.SelectionBarRight.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-handle vjs-selectionbar-right-RS",innerHTML:'<div class="vjs-selectionbar-arrow-RS"></div><div class="vjs-selectionbar-line-RS"></div>'})};videojs.SelectionBarRight.prototype.onMouseDown=function(c){c.preventDefault();videojs.blockTextSelection();if(!this.rs.options.locked){this.pressed=true;videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp));videojs.addClass(this.el_,"active")}};videojs.SelectionBarRight.prototype.onMouseUp=function(c){videojs.off(document,"mouseup",this.onMouseUp,false);videojs.removeClass(this.el_,"active");if(!this.rs.options.locked){this.pressed=false}};videojs.TimePanel=videojs.Component.extend({init:function(d,c){videojs.Component.call(this,d,c)}});videojs.TimePanel.prototype.init_=function(){this.rs=this.player_.rangeslider};videojs.TimePanel.prototype.options_={children:{TimePanelLeft:{},TimePanelRight:{},}};videojs.TimePanel.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-timepanel-RS"})};videojs.TimePanelLeft=videojs.Component.extend({init:function(d,c){videojs.Component.call(this,d,c)}});videojs.TimePanelLeft.prototype.init_=function(){this.rs=this.player_.rangeslider};videojs.TimePanelLeft.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-timepanel-left-RS",innerHTML:'<span class="vjs-time-text">00:00</span>'})};videojs.TimePanelRight=videojs.Component.extend({init:function(d,c){videojs.Component.call(this,d,c)}});videojs.TimePanelRight.prototype.init_=function(){this.rs=this.player_.rangeslider};videojs.TimePanelRight.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-timepanel-right-RS",innerHTML:'<span class="vjs-time-text">00:00</span>'})}})();